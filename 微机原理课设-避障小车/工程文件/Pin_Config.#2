

/**********************************************************************************************************
**** 文件名：Pin_Ccnfig.c
****
**** 文件描述：初始化函数集,延时函数
****
**** 
**** 创建人：YAN XIJUN
****
**** 版本号：1.0
**** 
**** 修改记录：
****
****
***********************************************************************************************************/

//-----------------------------------------------------------------------------
// 包含文件
//-----------------------------------------------------------------------------

#include "Pin_Config.h"

/*************************************************************************************************
*****引脚配置
**************************************************************************************************/
void Pin_Config()
{
	unsigned char SFRPAGE_save = SFRPAGE; 
	
	SFRPAGE = CONFIG_PAGE;
    XBR0|= 0x05;  //I2C、UART0使能
	              //SPI与UART0共用P0.1、P0.2先使能UART0；当SPI时，先关闭UART0，再使能SPI	              
	XBR1|= 0xC6;  //使能交叉开关，CEX0-5连接到管脚 PCA模拟I/O允许位

//  P0.0作为SPI的SCK;
//  P0.1、P0.2作为UART0的TX0、RX0；
//  P0.3作为SPI的NSS;
//  P0.4、P0.5为I2C的SDA、SCL;
//  P0.6=CPP0,P0.7=CPP1
	P0SKIP  |= 0x09;         //主板版本号：2012 3 28
	P0MDOUT |= 0xF6;    //配置P0.7-P0.4推挽输出
    P0MDIN &= ~0x04;    //P0.2为RX0输入

//  P1.0-P1.3为CPP2-CPP5
//  P1.4-P1.6为DIR1-DIR3，电机方向控制线
//  P1.7=ADC0,可复用，在实验版中用跳线选择	
	P1SKIP  |= 0xF0;    //交叉开关跳过模拟引脚P1.7       
	P1MDOUT |= 0x7F;    //配置P1.0、P1.1、P1.2、P1.3、P1.4、P1.5、P1.6推挽输出 	 
    P1MDIN &= ~0x80;    //P1.7模拟输入

//  P2口8路模拟输入，也可作数字量输入输出，在实验版中用跳线选择
	P2SKIP = 0xFF;      //交叉开关跳过模拟引脚
	P2MDIN = 0x00;      //P2模拟输入

//  P3.0=ADC9,可复用，在实验版中用跳线选择
//  P3.1-P3.4为DB0-DB3,LCD数据输入线
//  P3.5=DIR0,P3.6=DIR4,电机方向控制线
//  P3.7=DB4
//  LCD12864实际使用2线:SCLK=P3.3, 时钟信号线(实际与DB2复用); SID=P3.2，数据信号线(实际与DB1复用)  主板版本号：2012 3 28
//  主板版本号：2012 3 28
    P3SKIP  |= 0x01;    //交叉开关跳过模拟引脚P3.0
    P3MDOUT |= 0xFE;	//配置P3.1-P3.7为推挽输出
    P3MDIN &= ~0x01;    //P3.0模拟输入

//  P4.0-P4.2=DB5-DB7,LCD数据输入线，并行口未使用
//  P4.3-P4.5为LCD用3线串行接口的LCD_E、LCD_RW、LCD_RS
    P4MDOUT |= 0x7F;    //P3.4,P3.3为SID和SCLK均配置为漏极开路

	PCA0MD &= ~0x40;		//关闭看门狗

	EA = 1;					//开总中断

	SFRPAGE = SFRPAGE_save; 			
}

